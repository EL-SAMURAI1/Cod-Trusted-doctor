<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SAMURAI</title>
  <style>
    /* EL Samurai premium: dark glass + red/gold accents */
    :root{
      --bg1: #05060a;
      --bg2: #0b0f14;
      --glass: rgba(255,255,255,0.03);
      --accent1: #d43f3f;
      --accent2: #f6b93b;
      --muted: #9aa6b2;
      --card-radius: 16px;
      --maxw: 980px;
    }
    *{box-sizing:border-box;font-family:"Noto Kufi Arabic", Inter, system-ui, 'Segoe UI', Roboto, sans-serif}
    html,body{height:100%;margin:0;background:radial-gradient(1200px 600px at 10% 10%, rgba(212,63,63,0.06), transparent), linear-gradient(180deg,var(--bg1), #071018);color:#eaf2f7}
    .container{max-width:var(--maxw);margin:36px auto;padding:24px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:var(--card-radius);padding:22px;box-shadow:0 18px 50px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.02);backdrop-filter: blur(8px)}
    header{display:flex;align-items:center;gap:16px}
    .logo{width:72px;height:72px;border-radius:14px;background:linear-gradient(135deg,var(--accent1), #7c3aed);display:flex;align-items:center;justify-content:center;font-weight:900;font-size:22px;color:#fff;box-shadow:0 6px 18px rgba(124,58,237,0.08)}
    h1{margin:0;font-size:20px}
    p.lead{margin:6px 0 0 0;color:var(--muted);font-size:14px}
    .grid{display:grid;grid-template-columns:1fr 380px;gap:20px;margin-top:18px}
    @media(max-width:880px){.grid{grid-template-columns:1fr}}
    .col{display:flex;flex-direction:column;gap:12px}
    label{font-size:13px;color:var(--muted)}
    input[type=text], input[type=number], input[type=file], textarea{
      width:100%;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);
      background:linear-gradient(180deg, rgba(255,255,255,0.006), transparent);color:inherit;font-size:14px
    }
    .btn{display:inline-flex;align-items:center;gap:10px;padding:12px 18px;border-radius:12px;background:linear-gradient(90deg,var(--accent1),var(--accent2));border:none;color:#071018;font-weight:800;cursor:pointer;box-shadow:0 8px 28px rgba(212,63,63,0.12)}
    .btn.secondary{background:transparent;color:var(--accent1);border:1px solid rgba(212,63,63,0.12);font-weight:700}
    .muted{font-size:13px;color:var(--muted)}
    .summary{background:var(--glass);padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.02)}
    .summary h3{margin:0 0 10px 0}
    .summary .row{display:flex;justify-content:space-between;margin-bottom:8px}
    .recipient{display:flex;align-items:center;gap:10px;padding:12px;border-radius:10px;background:linear-gradient(90deg, rgba(212,63,63,0.05), rgba(246,185,59,0.02));border:1px solid rgba(212,63,63,0.08)}
    .recipient .num{font-weight:900;font-size:16px;letter-spacing:0.6px}
    .copyBtn{padding:8px 10px;border-radius:8px;border:none;background:transparent;color:var(--accent2);cursor:pointer;font-weight:800}
    .success{display:none;padding:12px;border-radius:8px;background:#052e1f;color:#bff1d6;margin-top:12px}
    .error{display:none;padding:12px;border-radius:8px;background:#3d0b0b;color:#ffd6d6;margin-top:12px;white-space:pre-wrap}
    footer.note{margin-top:14px;color:var(--muted);font-size:13px;text-align:right}
    .tiny{font-size:12px;color:var(--muted)}
    .flex{display:flex;gap:8px;align-items:center}
    .filePreview{max-height:140px;border-radius:10px;object-fit:cover;border:1px solid rgba(255,255,255,0.03)}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <header>
        <div style="flex:1">
          <h1>تأكيد شحن — فودافون كاش</h1>
          <p class="lead">اكتب بياناتك، ارفق إثبات الدفع واضغط تأكيد — سترى تأكيد الإرسال أو رسالة خطأ.</p>
        </div>
      </header>

      <div class="grid">
        <!-- LEFT: form -->
        <div class="col">
          <div>
            <label>Telegram ID</label>
            <input id="tgId" type="text" placeholder="مثال: 123456789" required />
            <div class="tiny">تاكد علي ان يكون هاذا ID حساب في البوت الخاص لنا</div>
          </div>

          <div>
            <label>رقم فودافون كاش (المُرسل)</label>
            <input id="phone" type="text" placeholder="01xxxxxxxx" pattern="[0-9]{10,11}" required />
          </div>

          <div>
            <label>المبلغ (جنيه)</label>
            <input id="amount" type="number" placeholder="مثال: 50" min="1" required />
          </div>

          <div>
            <label>ملاحظة (اختياري)</label>
            <textarea id="note" rows="3" placeholder="مرجع/تفاصيل"></textarea>
          </div>

          <div>
            <label>إثبات الدفع (صورة)</label>
            <input id="receipt" type="file" accept="image/*" />
            <div class="tiny">الحجم الموصى به أقل من 5MB. الصورة سترسل إلى خدمة العملاء لتاكيد الشحن.</div>
            <div style="margin-top:8px" id="previewWrap"></div>
          </div>

          <div style="margin-top:8px;display:flex;gap:10px;align-items:center">
            <button id="confirmBtn" class="btn">تأكيد الدفع</button>
            <button id="resetBtn" type="button" class="btn secondary">إفراغ الحقول</button>
          </div>

          <div class="success" id="successBox">تم الإرسال! افتح البوت على تليجرام للتحقق.</div>
          <div class="error" id="errorBox"></div>

        </div>

        <!-- RIGHT: summary -->
        <aside class="summary">
          <h3>ملخص الشحن</h3>

          <div class="row"><div class="muted">Telegram ID</div><div id="s_tg">—</div></div>
          <div class="row"><div class="muted">رقم المرسل</div><div id="s_phone">—</div></div>
          <div class="row"><div class="muted">المبلغ</div><div id="s_amount">—</div></div>
          <div class="row"><div class="muted">ملاحظة</div><div id="s_note">—</div></div>

          <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0" />

          <div class="muted">الرقم المستلم</div>
          <div class="recipient" style="margin-top:8px">
            <div class="num" id="destNumber">01505360380</div>
            <div class="flex" style="margin-left:auto">
              <button class="copyBtn" id="copyDest">نسخ الرقم</button>
              <button class="copyBtn" id="callDest">اتصال</button>
            </div>
          </div>

          <div style="margin-top:12px" class="tiny">ملحوظة: الرجاء التأكد من ارسال المبلغ علي نفس الرقم و الرجاء تاكيد بياناتك بشكل صحيح.</div>
        </aside>
      </div>

      <footer class="note">ملاحظة أمان: إذا حدث اي عطل الرجاء التوجه سريعا لفريق الدعم المتخصص و الرجاء التأكيد علي بياناتك قبل اتمام الدفع.</footer>
    </div>
  </div>

<script>
/*
  IMPORTANT:
  - Replace BOT_TOKEN and CHAT_ID below with your values BEFORE publishing.
  - WARNING: Putting BOT_TOKEN in client-side code is insecure and exposes the token publicly.
  - If Telegram blocks the request due to CORS, use a serverless proxy (I can help).
*/

const BOT_TOKEN = '8429224806:AAFE9c3MSGYFFMZBXivHA0Mvzcl-3t5Ed6U'; // <-- ضع توكين البوت هنا (لا تشاركه علناً)
const CHAT_ID   = '7484952367';   // <-- ضع chat_id أو @channel_username هنا

// Elements
const tgId = document.getElementById('tgId');
const phone = document.getElementById('phone');
const amount = document.getElementById('amount');
const note = document.getElementById('note');
const receipt = document.getElementById('receipt');
const confirmBtn = document.getElementById('confirmBtn');
const resetBtn = document.getElementById('resetBtn');

const s_tg = document.getElementById('s_tg');
const s_phone = document.getElementById('s_phone');
const s_amount = document.getElementById('s_amount');
const s_note = document.getElementById('s_note');

const destNumber = document.getElementById('destNumber');
const copyDest = document.getElementById('copyDest');
const callDest = document.getElementById('callDest');

const successBox = document.getElementById('successBox');
const errorBox = document.getElementById('errorBox');

const previewWrap = document.getElementById('previewWrap');

// Update summary live
tgId.addEventListener('input', e => s_tg.textContent = e.target.value || '—');
phone.addEventListener('input', e => s_phone.textContent = e.target.value || '—');
amount.addEventListener('input', e => s_amount.textContent = e.target.value ? (e.target.value + ' ج.م') : '—');
note.addEventListener('input', e => s_note.textContent = e.target.value || '—');

// File preview
receipt.addEventListener('change', () => {
  previewWrap.innerHTML = '';
  const f = receipt.files && receipt.files[0];
  if(f){
    if(f.size > 5 * 1024 * 1024){
      errorBox.style.display = 'block'; errorBox.textContent = 'حجم الصورة أكبر من 5MB.';
      receipt.value = '';
      return;
    }
    const img = document.createElement('img');
    img.src = URL.createObjectURL(f);
    img.className = 'filePreview';
    img.style.maxWidth = '100%';
    previewWrap.appendChild(img);
  }
});

// copy & call
copyDest.addEventListener('click', async () => {
  const num = destNumber.textContent.trim();
  try {
    await navigator.clipboard.writeText(num);
    copyDest.textContent = 'تم النسخ';
    setTimeout(()=> copyDest.textContent = 'نسخ الرقم', 1400);
  } catch (e) {
    alert('نسخ يدوي: ' + num);
  }
});
callDest.addEventListener('click', () => {
  const tel = destNumber.textContent.replace(/[^0-9+]/g,'');
  window.location.href = 'tel:' + tel;
});

// reset
resetBtn.addEventListener('click', () => {
  tgId.value = phone.value = amount.value = note.value = '';
  receipt.value = '';
  previewWrap.innerHTML = '';
  s_tg.textContent = s_phone.textContent = s_amount.textContent = s_note.textContent = '—';
  successBox.style.display = 'none'; errorBox.style.display = 'none';
});

// Main submit handler
confirmBtn.addEventListener('click', async (e) => {
  e.preventDefault();
  successBox.style.display = 'none'; errorBox.style.display = 'none';

  // validation
  if(!tgId.value.trim()){ errorBox.style.display='block'; errorBox.textContent='ادخل Telegram ID.'; return; }
  if(!phone.value.trim()){ errorBox.style.display='block'; errorBox.textContent='ادخل رقم فودافون كاش.'; return; }
  if(!amount.value || Number(amount.value) <= 0){ errorBox.style.display='block'; errorBox.textContent='ادخل مبلغ صحيح.'; return; }
  if(!receipt.files || receipt.files.length === 0){ errorBox.style.display='block'; errorBox.textContent='ارفق صورة الإيصال.'; return; }

  const file = receipt.files[0];
  if(file.size > 5 * 1024 * 1024){ errorBox.style.display='block'; errorBox.textContent='حجم الصورة أكبر من 5MB.'; return; }

  // prepare caption text
  const caption = `📩 تأكيد شحن جديد\n👤 Telegram ID: ${tgId.value.trim()}\n💰 المبلغ: ${amount.value} ج.م\n📱 رقم فودافون كاش: ${phone.value.trim()}\n📝 ملاحظة: ${note.value.trim() || '-'}\n⏱ ${new Date().toLocaleString()}`;

  // Build form-data for sendPhoto
  const fd = new FormData();
  fd.append('chat_id', CHAT_ID); // chat id or channel username
  fd.append('caption', caption);
  fd.append('parse_mode', 'HTML');
  fd.append('photo', file, file.name);

  // URL to Telegram sendPhoto
  const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`;

  // NOTE: This request may be blocked by CORS in the browser.
  // If you see a CORS error in console, use a serverless proxy (Cloudflare Worker etc).
  try {
    confirmBtn.disabled = true;
    confirmBtn.textContent = 'جاري الإرسال...';

    const res = await fetch(url, {
      method: 'POST',
      body: fd
    });

    if(!res.ok){
      // try to parse error message
      let text = await res.text().catch(()=> '');
      errorBox.style.display='block';
      errorBox.textContent = `خطأ في الإرسال — استجابة الخادم: ${res.status} ${res.statusText}\n${text}`;
      confirmBtn.disabled = false;
      confirmBtn.textContent = 'تأكيد الدفع وإرسال للبوت';
      // Common cause: CORS or bad token/chat_id
      return;
    }

    const json = await res.json().catch(()=> null);
    if(json && json.ok){
      successBox.style.display = 'block';
      successBox.textContent = 'تم الإرسال بنجاح — افحص البوت في تليجرام.';
      // keep fields or reset as you prefer:
      // resetBtn.click();
    } else {
      errorBox.style.display='block';
      errorBox.textContent = 'لم يتم إرسال الرسالة. تأكد من توكين البوت و chat_id، أو أن الـ API يسمح بالوصول.';
    }

  } catch (err){
    // Likely CORS or network error
    errorBox.style.display='block';
    errorBox.textContent = 'فشل الاتصال: ' + (err && err.message ? err.message : String(err)) + '\n\nملاحظة: إذا ظهر خطأ CORS في وحدة التحكم (Console) فهذا يعني أن المتصفح منع الطلب. استخدم خادم وسيط لحل المشكلة.';
  } finally{
    confirmBtn.disabled = false;
    confirmBtn.textContent = 'تأكيد الدفع وإرسال للبوت';
  }
});
</script>
</body>
  </html>
